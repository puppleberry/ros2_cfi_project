[CFI] === ROS2 CFI Day 6 (Final Version) ===
[CFI] PID: 6621
[CFI] Process: vulnerable_subs
[CFI] Strict mode ENABLED
[CFI] Debug mode ENABLED
[0;32m[CFI-SUCCESS] CFI initialized successfully![0m
[CFI] Waiting for ROS2 callbacks...
=== ROS2 ì½œë°± íƒ€ê²Ÿ ì·¨ì•½í•œ ë…¸ë“œ ===
ì´ ë…¸ë“œëŠ” ROS2 subscription ë©”ì»¤ë‹ˆì¦˜ ìì²´ë¥¼ ê³µê²©í•©ë‹ˆë‹¤.
[WARN] [1748676508.437652800] [improved_vulnerable_subscriber]: âš ï¸  ì´ ë…¸ë“œëŠ” ROS2 ì½œë°±ì„ íƒ€ê²Ÿìœ¼ë¡œ í•˜ëŠ” ì·¨ì•½ì ì„ í¬í•¨í•©ë‹ˆë‹¤!

=== ë©”ëª¨ë¦¬ ë ˆì´ì•„ì›ƒ ì •ë³´ ===
Context 0:
  buffer ì£¼ì†Œ: 0x647b298282c0
  subscription ì£¼ì†Œ: 0x647b29828330
  callback ì£¼ì†Œ: 0x647b298282f0
Context 1:
  buffer ì£¼ì†Œ: 0x647b29834e60
  subscription ì£¼ì†Œ: 0x647b29835010
  callback ì£¼ì†Œ: 0x647b29834e90
Context 2:
  buffer ì£¼ì†Œ: 0x647b2983c590
  subscription ì£¼ì†Œ: 0x647b2983c720
  callback ì£¼ì†Œ: 0x647b2983c5c0

ì•…ì„± ì½œë°± ì£¼ì†Œë“¤:
  malicious_callback: 0x647b0a3d65cc
  calculator_callback: 0x647b0a3d6938
[INFO] [1748676508.438407061] [improved_vulnerable_subscriber]: ë…¸ë“œê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤. ê³µê²© ëª…ë ¹:
[INFO] [1748676508.438416539] [improved_vulnerable_subscriber]: 1. ì •ìƒ ë©”ì‹œì§€: ros2 topic pub /vuln_topic_0 std_msgs/msg/String "data: 'Hello'"
[INFO] [1748676508.438423181] [improved_vulnerable_subscriber]: 2. ì˜¤ë²„í”Œë¡œìš°: ros2 topic pub /vuln_control std_msgs/msg/String "data: 'OVERFLOW <topic_id> <size>'"
[INFO] [1748676508.438427399] [improved_vulnerable_subscriber]: 3. í¬ì¸í„° ë®ì–´ì“°ê¸°: ros2 topic pub /vuln_control std_msgs/msg/String "data: 'CORRUPT <topic_id>'"
[0;36m[CFI-DEBUG] Searching for original function: _ZN6rclcpp8Executor20execute_subscriptionESt10shared_ptrINS_16SubscriptionBaseEE[0m
[0;36m[CFI-DEBUG] Found via RTLD_NEXT: 0x7e4a6905f600[0m
[0;32m[CFI-SUCCESS] === CFI Protection Active! First callback intercepted ===[0m
[0;36m[CFI-DEBUG] Intercepted call #1: executor=0x7ffd83fff890, subscription=0x7e4a6916a830[0m
[0;31m[CFI-ERROR] ğŸš¨ CFI VIOLATION: Unregistered subscription execution attempt![0m
[0;31m[CFI-ERROR]   Subscription pointer: 0x7e4a6916a830[0m
[0;31m[CFI-ERROR]   This subscription was never registered with CFI![0m
[0;31m[CFI-ERROR]   âŒ BLOCKING EXECUTION (strict mode)[0m
timeout: the monitored command dumped core
